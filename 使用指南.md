# PowerClean 快速使用指南

## 最简单的使用方法

### Windows下双击运行
1. 双击 `启动PowerClean.bat` 文件
2. 在弹出的菜单中选择相应的功能
3. 按提示操作即可

### PowerShell中运行
```powershell
cd d:\code\power_clean
.\PowerClean.ps1
```

## 菜单说明

启动后会看到以下菜单：

```
========================================
       PowerClean 系统管理工具
========================================

1. 查看最近项目显示状态
2. 启用最近项目显示
3. 禁用最近项目显示
4. 重启资源管理器

0. 退出程序

========================================
```

### 选项说明

**1. 查看最近项目显示状态**
- 显示当前系统中"最近项目"功能的状态
- 包括是否启用、跟踪文档、跟踪程序等信息
- 只读操作，不会修改任何设置

**2. 启用最近项目显示**
- 开启Windows开始菜单和任务栏的"最近项目"显示
- 启用后可以在右键菜单中看到最近使用的文件和程序
- 会询问是否立即重启资源管理器

**3. 禁用最近项目显示**
- 关闭Windows开始菜单和任务栏的"最近项目"显示
- 禁用后右键菜单将不再显示最近使用的项目
- 会询问是否立即重启资源管理器

**4. 重启资源管理器**
- 重启Windows资源管理器进程以应用更改
- 如果之前做了设置但没有立即重启，可以用这个选项
- 会暂时关闭所有文件资源管理器窗口，然后自动重新打开

**0. 退出程序**
- 退出PowerClean程序

## 注意事项

1. **需要确认操作**
   - 所有修改操作都会要求确认
   - 可以随时输入 N 取消操作

2. **重启资源管理器**
   - 修改设置后建议重启资源管理器
   - 重启会暂时关闭桌面，1-2秒后会自动恢复
   - 如果不想立即重启，可以稍后手动重启或重新登录

3. **安全性**
   - 所有操作都是可逆的
   - 只修改当前用户的注册表设置
   - 不需要管理员权限

## 高级使用

如果您熟悉PowerShell，也可以直接导入模块使用命令：

```powershell
# 导入模块
Import-Module .\PowerClean.psd1

# 查看状态
Get-RecentItemsStatus

# 禁用最近项目
Disable-RecentItems

# 启用最近项目
Enable-RecentItems

# 启用并自动重启资源管理器
Enable-RecentItems -RestartExplorer

# 手动重启资源管理器
Restart-Explorer
```

## 快捷脚本

在 `Examples` 文件夹中有一些快捷脚本：

- **Quick-Disable.ps1** - 快速禁用，无需菜单
- **Quick-Enable.ps1** - 快速启用，无需菜单

右键这些文件选择"使用PowerShell运行"即可。

## 常见问题

**Q: 为什么修改后没有效果？**
A: 需要重启资源管理器或重新登录才能看到效果。建议在操作时选择"是"来立即重启资源管理器。

**Q: 重启资源管理器安全吗？**
A: 完全安全。这只是重启显示界面的进程，不会影响其他正在运行的程序。

**Q: 可以恢复吗？**
A: 可以。只需再次运行程序，选择相反的操作即可（启用禁用）。

**Q: 会影响其他用户吗？**
A: 不会。只修改当前登录用户的设置。

## 技术支持

如有问题，请查看 `README.md` 获取更多信息。
