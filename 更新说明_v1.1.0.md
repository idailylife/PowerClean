# PowerClean v1.1.0 更新说明

## 新增功能

### 1. 快速访问管理
新增对文件资源管理器"快速访问"的完整控制：
- **最近使用的文件**：控制快速访问中最近打开文件的显示
- **常用文件夹**：控制快速访问中常用文件夹的显示
- 独立控制，灵活配置

### 2. 二级菜单结构
重新设计了用户界面：
- **一级菜单**：选择功能模块（最近项目管理/快速访问管理）
- **二级菜单**：进入后自动显示当前状态，然后选择具体操作
- 更加清晰直观，用户体验大幅提升

### 3. 自动状态显示
- 进入任何功能模块后，首先显示当前配置状态
- 让用户清楚了解系统当前设置
- 操作后立即显示最新状态

## 功能模块

### 模块一：开始菜单和任务栏 - 最近项目管理
```

   开始菜单和任务栏 - 最近项目管理


最近项目显示状态:
==================
状态: 已启用
跟踪文档: True
跟踪程序: True



  1. 启用最近项目显示
  2. 禁用最近项目显示

  0. 返回主菜单
```

### 模块二：文件资源管理器 - 快速访问管理
```

  文件资源管理器 - 快速访问管理


快速访问设置状态:
==================
最近使用的文件: 已启用
常用文件夹: 已启用



【最近使用的文件】
  1. 启用最近文件显示
  2. 禁用最近文件显示

【常用文件夹】
  3. 启用常用文件夹显示
  4. 禁用常用文件夹显示

  0. 返回主菜单
```

## PowerShell命令

### 快速访问相关命令

查看状态：
```powershell
Get-QuickAccessStatus
```

最近文件管理：
```powershell
# 启用最近文件
Enable-QuickAccessRecentFiles

# 禁用最近文件
Disable-QuickAccessRecentFiles

# 启用并立即重启资源管理器
Enable-QuickAccessRecentFiles -RestartExplorer
```

常用文件夹管理：
```powershell
# 启用常用文件夹
Enable-QuickAccessFrequentFolders

# 禁用常用文件夹
Disable-QuickAccessFrequentFolders

# 禁用并立即重启资源管理器
Disable-QuickAccessFrequentFolders -RestartExplorer
```

## 技术细节

### 注册表位置
快速访问设置位于：
- 路径：`HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer`
- ShowRecent：控制最近使用的文件（0=禁用，1=启用）
- ShowFrequent：控制常用文件夹（0=禁用，1=启用）

### 模块文件
- `Functions/RecentItems.ps1` - 最近项目管理功能
- `Functions/QuickAccess.ps1` - 快速访问管理功能（新增）
- `PowerClean.ps1` - 主程序（重构为二级菜单）

## 升级说明

如果您从v1.0.0升级：
1. 所有原有功能完全保留
2. 新增快速访问管理功能
3. 菜单结构优化，但操作逻辑相同
4. 无需重新配置，直接使用即可

## 使用建议

1. **隐私保护**：如果不希望显示最近打开的文件，可以：
   - 禁用"开始菜单-最近项目"（模块1）
   - 禁用"快速访问-最近文件"（模块2）

2. **干净体验**：彻底隐藏所有历史记录：
   - 模块1：禁用最近项目
   - 模块2：禁用最近文件和常用文件夹

3. **推荐配置**：
   - 如需快速访问工作文件：全部启用
   - 如需保护隐私：全部禁用
   - 可以根据需要独立控制每个选项

## 版本历史

**v1.1.0** (2025-12-09)
-  新增快速访问管理功能
-  重构为二级菜单结构
-  自动显示当前状态
-  优化用户体验

**v1.0.0** (2025-12-09)
-  初始版本
- 支持最近项目显示管理
- 完整的中文支持
